{% extends "base.html" %}

{% block title %}λ‚΄ MBTI κ²°κ³Ό - {{ mbti_type }} - 360Me{% endblock %}

{% block head %}
    {{ super() }}
    {% if robots_meta %}
    <meta name="robots" content="{{ robots_meta }}">
    {% endif %}
{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto">
    <div class="text-center mb-8">
        <h1 class="text-4xl font-bold text-gray-800 mb-4">
            π‰ λ‚΄ MBTI κ²°κ³Ό
        </h1>
        <p class="text-xl text-gray-600">
            μκΈ° ν‰κ°€ ν…μ¤νΈκ°€ μ™„λ£λμ—μµλ‹λ‹¤!
        </p>
    </div>

    <!-- MBTI Result Card -->
    <div class="bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg shadow-xl p-8 mb-8">
        <div class="text-center">
            <div class="text-8xl mb-4">π§ </div>
            <h2 class="text-5xl font-bold mb-2">{{ mbti_type }}</h2>
            <h3 class="text-2xl font-semibold mb-4">{{ result.title }}</h3>
            <p class="text-xl opacity-90">{{ result.description }}</p>
        </div>
    </div>

    <!-- Score Breakdown -->
    <div class="grid md:grid-cols-2 gap-8 mb-8">
        <div class="bg-white rounded-lg shadow-lg p-6">
            <h3 class="text-xl font-bold text-gray-800 mb-4">μ„±ν–¥ λ¶„μ„</h3>
            <div class="space-y-4">
                <div>
                    <div class="flex justify-between mb-2">
                        <span class="font-semibold">μ™Έν–¥μ„± (E)</span>
                        <span class="text-blue-600">{{ scores.E }}%</span>
                    </div>
                    <div class="flex justify-between mb-2">
                        <span class="font-semibold">λ‚΄ν–¥μ„± (I)</span>
                        <span class="text-blue-600">{{ scores.I }}%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                        <div class="bg-blue-600 h-2 rounded-full" style="width: {{ scores.E }}%"></div>
                    </div>
                </div>

                <div>
                    <div class="flex justify-between mb-2">
                        <span class="font-semibold">κ°κ° (S)</span>
                        <span class="text-green-600">{{ scores.S }}%</span>
                    </div>
                    <div class="flex justify-between mb-2">
                        <span class="font-semibold">μ§κ΄€ (N)</span>
                        <span class="text-green-600">{{ scores.N }}%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                        <div class="bg-green-600 h-2 rounded-full" style="width: {{ scores.S }}%"></div>
                    </div>
                </div>

                <div>
                    <div class="flex justify-between mb-2">
                        <span class="font-semibold">μ‚¬κ³  (T)</span>
                        <span class="text-purple-600">{{ scores.T }}%</span>
                    </div>
                    <div class="flex justify-between mb-2">
                        <span class="font-semibold">κ°μ • (F)</span>
                        <span class="text-purple-600">{{ scores.F }}%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                        <div class="bg-purple-600 h-2 rounded-full" style="width: {{ scores.T }}%"></div>
                    </div>
                </div>

                <div>
                    <div class="flex justify-between mb-2">
                        <span class="font-semibold">νλ‹¨ (J)</span>
                        <span class="text-orange-600">{{ scores.J }}%</span>
                    </div>
                    <div class="flex justify-between mb-2">
                        <span class="font-semibold">μΈμ‹ (P)</span>
                        <span class="text-orange-600">{{ scores.P }}%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                        <div class="bg-orange-600 h-2 rounded-full" style="width: {{ scores.J }}%"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="bg-white rounded-lg shadow-lg p-6">
            <h3 class="text-xl font-bold text-gray-800 mb-4">MBTI μ ν• μ„¤λ…</h3>
            <div class="space-y-4">
                <div>
                    <h4 class="font-semibold text-gray-800">{{ mbti_type[0] }} - {{ "μ™Έν–¥μ„±" if mbti_type[0] == "E" else "λ‚΄ν–¥μ„±" }}</h4>
                    <p class="text-sm text-gray-600">
                        {% if mbti_type[0] == "E" %}
                        ν™λ°ν•κ³  μ‚¬κµμ μ΄λ©°, λ‹¤λ¥Έ μ‚¬λλ“¤κ³Όμ μƒνΈμ‘μ©μ„ ν†µν•΄ μ—λ„μ§€λ¥Ό μ–»μµλ‹λ‹¤.
                        {% else %}
                        μ΅°μ©ν•κ³  μ‹ μ¤‘ν•λ©°, νΌμλ§μ μ‹κ°„μ„ ν†µν•΄ μ—λ„μ§€λ¥Ό μ–»μµλ‹λ‹¤.
                        {% endif %}
                    </p>
                </div>

                <div>
                    <h4 class="font-semibold text-gray-800">{{ mbti_type[1] }} - {{ "κ°κ°" if mbti_type[1] == "S" else "μ§κ΄€" }}</h4>
                    <p class="text-sm text-gray-600">
                        {% if mbti_type[1] == "S" %}
                        κµ¬μ²΄μ μ΄κ³  μ‹¤μ©μ μ΄λ©°, ν„μ¬μ μ‚¬μ‹¤κ³Ό μ„Έλ¶€μ‚¬ν•­μ— μ§‘μ¤‘ν•©λ‹λ‹¤.
                        {% else %}
                        μ°½μμ μ΄κ³  λ―Έλμ§€ν–¥μ μ΄λ©°, κ°€λ¥μ„±κ³Ό ν¨ν„΄μ„ μ¶”κµ¬ν•©λ‹λ‹¤.
                        {% endif %}
                    </p>
                </div>

                <div>
                    <h4 class="font-semibold text-gray-800">{{ mbti_type[2] }} - {{ "μ‚¬κ³ " if mbti_type[2] == "T" else "κ°μ •" }}</h4>
                    <p class="text-sm text-gray-600">
                        {% if mbti_type[2] == "T" %}
                        λ…Όλ¦¬μ μ΄κ³  κ°κ΄€μ μ΄λ©°, μ›μΉ™κ³Ό μΌκ΄€μ„±μ„ μ¤‘μ‹ν•©λ‹λ‹¤.
                        {% else %}
                        κ³µκ°μ μ΄κ³  μ£Όκ΄€μ μ΄λ©°, μ΅°ν™”μ™€ κ°€μΉλ¥Ό μ¤‘μ‹ν•©λ‹λ‹¤.
                        {% endif %}
                    </p>
                </div>

                <div>
                    <h4 class="font-semibold text-gray-800">{{ mbti_type[3] }} - {{ "νλ‹¨" if mbti_type[3] == "J" else "μΈμ‹" }}</h4>
                    <p class="text-sm text-gray-600">
                        {% if mbti_type[3] == "J" %}
                        μ²΄κ³„μ μ΄κ³  κ³„νμ μ΄λ©°, κ²°μ •μ„ λ‚΄λ¦¬κ³  λ§λ¬΄λ¦¬ν•λ” κ²ƒμ„ μ„ νΈν•©λ‹λ‹¤.
                        {% else %}
                        μ μ—°ν•κ³  μ μ‘μ μ΄λ©°, μ„ νƒμ§€λ¥Ό μ—΄μ–΄λ‘κ³  μƒν™©μ— λ”°λΌ λ€μ‘ν•©λ‹λ‹¤.
                        {% endif %}
                    </p>
                </div>
            </div>
        </div>
    </div>

    <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
        <h3 class="text-xl font-bold text-gray-800 mb-3">μΉκµ¬μ—κ² κ²€μ‚¬ μ”μ²­ν•κΈ°</h3>
        <p class="text-sm text-gray-700 mb-2">κ³µμ μ μ΄λ¦„: <strong>{{ owner_name or 'κ³µμ μ' }}</strong></p>
        <p class="text-sm text-gray-600 mb-4">μ•„λ λ§ν¬λ¥Ό λ³µμ‚¬ν•΄μ„ κ³µμ ν•λ©΄, μƒλ€κ°€ κ΄€κ³„λ¥Ό κ³ λ¥΄κ³  λ‚λ¥Ό κΈ°μ¤€μΌλ΅ MBTI μΈμ‹ ν‰κ°€λ¥Ό μ§„ν–‰ν•  μ μμµλ‹λ‹¤.</p>
        <div class="flex flex-col gap-3 sm:flex-row">
            <input id="shareLinkFromSelf" type="text" readonly value="{{ invite_url }}" class="w-full rounded-lg border border-gray-300 px-4 py-3 text-sm text-gray-700">
            <button type="button" id="copyShareLinkBtn" class="bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-3 px-5 rounded-lg transition duration-300">
                λ§ν¬ λ³µμ‚¬
            </button>
        </div>
    </div>

    {% if owner_exchange_url %}
    <div class="bg-amber-50 border border-amber-200 rounded-lg shadow-sm p-6 mb-8">
        <h3 class="text-lg font-bold text-amber-900 mb-2">μ§„ν–‰ ν„ν™©(λ‚λ§ λ³΄κΈ°)</h3>
        <p class="text-sm text-amber-900/80 mb-4">μ‘λ‹µμ΄ λ‡ κ° λ¨μ€λ”μ§€ ν™•μΈν•κ³ , λ¦¬ν¬νΈκ°€ μ—΄λ¦¬λ” μκ°„μ„ ν™•μΈν•  μ μμ–΄μ”.</p>
        <a href="{{ owner_exchange_url }}" class="inline-flex items-center justify-center bg-amber-600 hover:bg-amber-700 text-white font-bold py-3 px-5 rounded-lg transition duration-300">
            μ§„ν–‰ ν„ν™© λ³΄κΈ°
        </a>
    </div>
    {% endif %}

    <!-- Action Buttons -->
    <div class="text-center space-y-4">
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
            <a href="/mbti/self-test" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
                λ‹¤μ‹ ν…μ¤νΈν•κΈ°
            </a>
            <a href="/mbti/friend-system" class="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
                μΉκµ¬ ν‰κ°€ν•κΈ°
            </a>
            <a href="/mbti/types" class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
                λ¨λ“  MBTI μ ν• λ³΄κΈ°
            </a>
        </div>
        
        <div class="mt-8">
            <a href="/" class="text-gray-600 hover:text-gray-800 font-semibold transition duration-300">
                β† λ©”μΈ νμ΄μ§€λ΅ λμ•„κ°€κΈ°
            </a>
        </div>
    </div>
</div>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const input = document.getElementById('shareLinkFromSelf');
    const button = document.getElementById('copyShareLinkBtn');

    if (!input || !button) {
        return;
    }

    const setCopied = function () {
        const before = button.textContent;
        button.textContent = 'λ³µμ‚¬ μ™„λ£!';
        setTimeout(function () {
            button.textContent = before;
        }, 1800);
    };

    button.addEventListener('click', function () {
        const value = input.value || '';
        if (!value) {
            return;
        }
        if (navigator.clipboard && navigator.clipboard.writeText) {
            navigator.clipboard.writeText(value).then(setCopied).catch(function () {
                input.focus();
                input.select();
                if (document.execCommand('copy')) {
                    setCopied();
                }
            });
            return;
        }

        input.focus();
        input.select();
        if (document.execCommand('copy')) {
            setCopied();
        }
    });
});
</script>
{% endblock %} 
